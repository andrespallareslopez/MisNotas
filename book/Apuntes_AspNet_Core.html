<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Apuntes AspNet Core - Mis notas</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="custom.css">
        <link rel="stylesheet" href="custom2.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="Apuntes ALM.html"><strong aria-hidden="true">1.</strong> Apuntes ALM</a></li><li class="chapter-item "><a href="Apuntes AspNet Handfire.html"><strong aria-hidden="true">2.</strong> Apuntes AspNet Handfire</a></li><li class="chapter-item "><a href="Apuntes Azure Lista.html"><strong aria-hidden="true">3.</strong> Azure</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Apuntes Azure AD.html"><strong aria-hidden="true">3.1.</strong> Apuntes Azure AD</a></li><li class="chapter-item "><a href="Apuntes Azure App Service.html"><strong aria-hidden="true">3.2.</strong> Apuntes Azure App Service.md</a></li><li class="chapter-item "><a href="Apuntes Azure Devops.html"><strong aria-hidden="true">3.3.</strong> Apuntes Azure Devops</a></li><li class="chapter-item "><a href="Apuntes Azure Functions.html"><strong aria-hidden="true">3.4.</strong> Apuntes Azure Functions</a></li><li class="chapter-item "><a href="Apuntes Azure Service Fabric.html"><strong aria-hidden="true">3.5.</strong> Apuntes Azure Service Fabric</a></li><li class="chapter-item "><a href="Apuntes Azure Sql Server.html"><strong aria-hidden="true">3.6.</strong> Apuntes Azure Sql Server</a></li><li class="chapter-item "><a href="Apuntes Azure.html"><strong aria-hidden="true">3.7.</strong> Apuntes Azure</a></li></ol></li><li class="chapter-item "><a href="Apuntes Consul.html"><strong aria-hidden="true">4.</strong> Apuntes Consul</a></li><li class="chapter-item "><a href="Apuntes CSS.html"><strong aria-hidden="true">5.</strong> Apuntes CSS</a></li><li class="chapter-item "><a href="Apuntes Expresiones Regulares.html"><strong aria-hidden="true">6.</strong> Apuntes Expresiones Regulares</a></li><li class="chapter-item "><a href="apuntes influxdb.html"><strong aria-hidden="true">7.</strong> Apuntes influxdb</a></li><li class="chapter-item "><a href="Apuntes jenkins basico.html"><strong aria-hidden="true">8.</strong> Apuntes jenkins basico</a></li><li class="chapter-item "><a href="Apuntes Nomad.html"><strong aria-hidden="true">9.</strong> Apuntes Nomad</a></li><li class="chapter-item "><a href="Apuntes Packer.html"><strong aria-hidden="true">10.</strong> Apuntes Packer</a></li><li class="chapter-item "><a href="Apuntes Proyectos.html"><strong aria-hidden="true">11.</strong> Apuntes Proyectos</a></li><li class="chapter-item "><a href="Apuntes React Lista.html"><strong aria-hidden="true">12.</strong> React</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Apuntes React Context.html"><strong aria-hidden="true">12.1.</strong> Apuntes React Context</a></li><li class="chapter-item "><a href="Apuntes React Formik.html"><strong aria-hidden="true">12.2.</strong> Apuntes React Formik</a></li><li class="chapter-item "><a href="Apuntes React Hooks.html"><strong aria-hidden="true">12.3.</strong> Apuntes React Hooks</a></li><li class="chapter-item "><a href="Apuntes React useCallback.html"><strong aria-hidden="true">12.4.</strong> Apuntes React useCallback</a></li><li class="chapter-item "><a href="Apuntes React useContext.html"><strong aria-hidden="true">12.5.</strong> Apuntes React useContext</a></li><li class="chapter-item "><a href="Apuntes React useReducer context.html"><strong aria-hidden="true">12.6.</strong> Apuntes React useReducer</a></li><li class="chapter-item "><a href="Apuntes React useRef.html"><strong aria-hidden="true">12.7.</strong> Apuntes React useRef</a></li><li class="chapter-item "><a href="Apuntes Reatjs.html"><strong aria-hidden="true">12.8.</strong> Apuntes Reactjs</a></li><li class="chapter-item "><a href="Apuntes Redux.html"><strong aria-hidden="true">12.9.</strong> Apuntes Redux</a></li><li class="chapter-item "><a href="Apuntes_gatsby.html"><strong aria-hidden="true">12.10.</strong> Apuntes Gatsby</a></li></ol></li><li class="chapter-item "><a href="Apuntes Rust.html"><strong aria-hidden="true">13.</strong> Apuntes Rust</a></li><li class="chapter-item "><a href="Apuntes Tailwind.html"><strong aria-hidden="true">14.</strong> Apuntes Tailwind</a></li><li class="chapter-item "><a href="Apuntes TemplateT4.html"><strong aria-hidden="true">15.</strong> Apuntes TemplateT4</a></li><li class="chapter-item "><a href="Apuntes Terraform Azure.html"><strong aria-hidden="true">16.</strong> Apuntes Terraform Azure</a></li><li class="chapter-item "><a href="Apuntes UrlRewrite.html"><strong aria-hidden="true">17.</strong> Apuntes UrlRewrite</a></li><li class="chapter-item "><div><strong aria-hidden="true">18.</strong> Windows Server</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Apuntes windows 2019.html"><strong aria-hidden="true">18.1.</strong> Apuntes windows 2019</a></li><li class="chapter-item "><a href="Apuntes windows ADDS.html"><strong aria-hidden="true">18.2.</strong> Apuntes windows ADDS</a></li><li class="chapter-item "><a href="Apuntes windows ADFS.html"><strong aria-hidden="true">18.3.</strong> Apuntes windows ADFS</a></li><li class="chapter-item "><a href="Apuntes Windows Core.html"><strong aria-hidden="true">18.4.</strong> Apuntes Windows Core</a></li><li class="chapter-item "><a href="Apuntes windows DNS.html"><strong aria-hidden="true">18.5.</strong> Apuntes Windows DNS</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">19.</strong> Asp.Net</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Apuntes_ApiGateway_Ocelot.html"><strong aria-hidden="true">19.1.</strong> Apuntes ApiGateway ocelot</a></li><li class="chapter-item "><a href="Apuntes_AspNET_Clasico_Inyeccion_Dependencies_01.html"><strong aria-hidden="true">19.2.</strong> Apuntes AspNet Clasico Inyeccion de dependencias</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_GraphQL_01.html"><strong aria-hidden="true">19.3.</strong> Apuntes AspNet Core GraphQL 01</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_GraphQL_02.html"><strong aria-hidden="true">19.4.</strong> Apuntes AspNet Core GraphQL 02</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_GraphQL_03.html"><strong aria-hidden="true">19.5.</strong> Apuntes AspNet Core GraphQL 03</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_GraphQL_04.html"><strong aria-hidden="true">19.6.</strong> Apuntes AspNet Core GraphQL 04</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_GraphQL_05.html"><strong aria-hidden="true">19.7.</strong> Apuntes AspNet Core GraphQL 05</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_Inyeccion_Dependencias_01.html"><strong aria-hidden="true">19.8.</strong> Apuntes AspNet Core Inyeccion Dependencias 01</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_Inyeccion_Dependencias_02.html"><strong aria-hidden="true">19.9.</strong> Apuntes AspNet Core Inyeccion Dependencias 02</a></li><li class="chapter-item "><a href="Apuntes_Aspnet_Core_Inyeccion_Dependencias_03.html"><strong aria-hidden="true">19.10.</strong> Apuntes AspNet Core Inyeccion Dependencias 03</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_Inyeccion_Dependencias_04.html"><strong aria-hidden="true">19.11.</strong> Apuntes AspNet Core Inyeccion Dependencias 04</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_Inyeccion_Dependencias_05.html"><strong aria-hidden="true">19.12.</strong> Apuntes AspNet Core Inyeccion Dependencias 05</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_Inyeccion_Dependencias_06.html"><strong aria-hidden="true">19.13.</strong> Apuntes AspNet Core Inyeccion Dependencias 06</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_Inyeccion_Dependencias_07.html"><strong aria-hidden="true">19.14.</strong> Apuntes AspNet Core Inyeccion Dependencias 07</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Core_Serilog_SqlServer.html"><strong aria-hidden="true">19.15.</strong> Apuntes AspNet Core Serilog Sql Server</a></li><li class="chapter-item expanded "><a href="Apuntes_AspNet_Core.html" class="active"><strong aria-hidden="true">19.16.</strong> Apuntes AspNet Core</a></li><li class="chapter-item "><a href="Apuntes_AspNet_Identidy.html"><strong aria-hidden="true">19.17.</strong> Apuntes AspNet Idendity</a></li><li class="chapter-item "><a href="Apuntes_AspNet_IdentityServer4.html"><strong aria-hidden="true">19.18.</strong> Apuntes AspNet IdentityServer4</a></li><li class="chapter-item "><a href="Apuntes_AspNET_SignalR_01.html"><strong aria-hidden="true">19.19.</strong> Apuntes AspNet SignalR 01</a></li><li class="chapter-item "><a href="Apuntes_AspNet_SignalR.html"><strong aria-hidden="true">19.20.</strong> Apuntes AspNet SignalR</a></li><li class="chapter-item "><a href="Apuntes_Blazor.html"><strong aria-hidden="true">19.21.</strong> Apuntes AspNet Blazor</a></li><li class="chapter-item "><a href="Apuntes_ErrorExceptionWeb.html"><strong aria-hidden="true">19.22.</strong> Apuntes Error Excepcion Web</a></li><li class="chapter-item "><a href="Apuntes_Net5_Y_Docker.html"><strong aria-hidden="true">19.23.</strong> Apuntes Net5 y Docker</a></li><li class="chapter-item "><a href="ApuntesEF.html"><strong aria-hidden="true">19.24.</strong> Apuntes EF</a></li><li class="chapter-item "><a href="ApuntesMVC I.html"><strong aria-hidden="true">19.25.</strong> Apuntes MVC I</a></li><li class="chapter-item "><a href="ApuntesMVC II.html"><strong aria-hidden="true">19.26.</strong> Apuntes MVC II</a></li><li class="chapter-item "><a href="ApuntesNancy.html"><strong aria-hidden="true">19.27.</strong> Apuntes Nancy</a></li><li class="chapter-item "><a href="ApuntesNet.html"><strong aria-hidden="true">19.28.</strong> Apuntes Net</a></li><li class="chapter-item "><a href="ApuntesNinject.html"><strong aria-hidden="true">19.29.</strong> Apuntes Ninject</a></li><li class="chapter-item "><a href="ApuntesOptimizacion.html"><strong aria-hidden="true">19.30.</strong> Apuntes Optimizacion Framework</a></li><li class="chapter-item "><a href="apuntesOwin.html"><strong aria-hidden="true">19.31.</strong> Apuntes OWIN</a></li><li class="chapter-item "><a href="ApuntesWebApi.html"><strong aria-hidden="true">19.32.</strong> Apuntes Web Api</a></li><li class="chapter-item "><a href="ApuntesWebApiCore.html"><strong aria-hidden="true">19.33.</strong> Apuntes Web Api Core</a></li><li class="chapter-item "><a href="asp.net core webapi-ef template.html"><strong aria-hidden="true">19.34.</strong> Apuntes Asp.net core Web Api-EF Template</a></li><li class="chapter-item "><a href="asp.net core-EF.html"><strong aria-hidden="true">19.35.</strong> Apuntes Asp.net Core-EF</a></li><li class="chapter-item "><a href="asp.net core-MVC.html"><strong aria-hidden="true">19.36.</strong> Apuntes Asp.net Core-MVC</a></li><li class="chapter-item "><a href="Blazor_Apuntes.html"><strong aria-hidden="true">19.37.</strong> Apuntes Blazor</a></li><li class="chapter-item "><a href="ApuntesAutofac.html"><strong aria-hidden="true">19.38.</strong> Apuntes AutoFac</a></li></ol></li><li class="chapter-item "><a href="ApuntesDocker.html"><strong aria-hidden="true">20.</strong> Apuntes Docker I</a></li><li class="chapter-item "><a href="ApuntesDocker II.html"><strong aria-hidden="true">21.</strong> Apuntes Docker II</a></li><li class="chapter-item "><a href="ApuntesNGINX.html"><strong aria-hidden="true">22.</strong> Apuntes NGINX</a></li><li class="chapter-item "><a href="ApuntesJavascript.html"><strong aria-hidden="true">23.</strong> Apuntes Javascript I</a></li><li class="chapter-item "><a href="ApuntesJavascriptII.html"><strong aria-hidden="true">24.</strong> Apuntes Javascript II</a></li><li class="chapter-item "><a href="ApuntesKubernetes.html"><strong aria-hidden="true">25.</strong> Apuntes Kubernetes</a></li><li class="chapter-item "><a href="ApuntesGit.html"><strong aria-hidden="true">26.</strong> Apuntes Git</a></li><li class="chapter-item "><a href="webpack.html"><strong aria-hidden="true">27.</strong> Apuntes WebPack</a></li><li class="chapter-item "><a href="Apuntes-Angular.html"><strong aria-hidden="true">28.</strong> Apuntes Angular</a></li><li class="chapter-item "><a href="Apuntes_wasm.html"><strong aria-hidden="true">29.</strong> Apuntes WebAssembly</a></li><li class="chapter-item "><a href="apuntesCache.html"><strong aria-hidden="true">30.</strong> Apuntes Asp Cache</a></li><li class="chapter-item "><a href="apuntesCacheRedis.html"><strong aria-hidden="true">31.</strong> Apuntes Asp Cache Redix</a></li><li class="chapter-item "><a href="ApuntesActivarSSL.html"><strong aria-hidden="true">32.</strong> Apuntes Activar SSL</a></li><li class="chapter-item "><a href="Apuntes_certificados.html"><strong aria-hidden="true">33.</strong> Apuntes Certificados</a></li><li class="chapter-item "><a href="Apuntes_OAUTH20.html"><strong aria-hidden="true">34.</strong> Apuntes OAUTH 2.0</a></li><li class="chapter-item "><a href="ApuntesSeguridad.html"><strong aria-hidden="true">35.</strong> Apuntes Seguridad</a></li><li class="chapter-item "><a href="Apuntes_PowerShell.html"><strong aria-hidden="true">36.</strong> Apuntes PowerShell</a></li><li class="chapter-item "><a href="ApuntesTypescript.html"><strong aria-hidden="true">37.</strong> Apuntes TypeScript</a></li><li class="chapter-item "><a href="ApuntesRequirejs.html"><strong aria-hidden="true">38.</strong> Apuntes RequireJS</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Mis notas</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<h2 id="titulo-apuntes-aspnet-core"><a class="header" href="#titulo-apuntes-aspnet-core">Titulo: &quot;Apuntes Asp.Net Core&quot;</a></h2>
<h1 id="apuntes-aspnet-core"><a class="header" href="#apuntes-aspnet-core">Apuntes Asp.Net Core</a></h1>
<ul>
<li><a href="#apuntes-aspnet-core">Apuntes Asp.Net Core</a>
<ul>
<li><a href="#net-core-31-cookie-authentication">NET CORE 3.1 Cookie Authentication</a></li>
<li><a href="#aspnet-core-20-cookie-authentication--local-logins">ASP.NET Core 2.0 Cookie Authentication – Local logins</a></li>
<li><a href="#cookie-authentication-in-aspnet-core-2-without-aspnet-identity">Cookie authentication in ASP.NET Core 2 without ASP.NET Identity</a></li>
<li><a href="#getting-started-with-entity-framework-core---aspnet-core">Getting Started With Entity Framework Core - ASP.NET Core</a></li>
<li><a href="#creacion-de-una-aplicacion-aspnet-core">Creacion de una aplicacion ASP.NET core</a></li>
<li><a href="#tutorial-introducci%C3%B3n-a-ef-core-en-una-aplicaci%C3%B3n-web-de-aspnet-core-mvc">Tutorial: Introducción a EF Core en una aplicación web de ASP.NET Core MVC</a></li>
<li><a href="#haciendo-f%C3%A1cil-el-acceso-a-datos-con-entity-framework-core-parte-2">Haciendo fácil el acceso a datos con Entity Framework Core (Parte 2)</a></li>
<li><a href="#entity-framework-core-code-first-en-visual-studio">Entity Framework Core «Code First» en Visual Studio</a></li>
<li><a href="#entity-framework-core-code-first-en-dotnet-cli">Entity Framework Core «Code First» en DotNet CLI</a></li>
<li><a href="#logging-in-aspnet-core">Logging in ASP.NET Core</a></li>
<li><a href="#crud-fullstack-react-js-aspnet-core-y-sql-server--tutorial-en-espa%C3%B1ol--parte-1">CRUD FullStack React JS, ASP.NET Core y SQL Server || Tutorial en Español || Parte 1</a></li>
</ul>
</li>
</ul>
<h3 id="net-core-31-cookie-authentication"><a class="header" href="#net-core-31-cookie-authentication">NET CORE 3.1 Cookie Authentication</a></h3>
<p>https://bjdejongblog.nl/net-core-3-1-cookie-authentication/</p>
<hr />
<h3 id="aspnet-core-20-cookie-authentication--local-logins"><a class="header" href="#aspnet-core-20-cookie-authentication--local-logins">ASP.NET Core 2.0 Cookie Authentication – Local logins</a></h3>
<p>http://codereform.com/blog/post/asp-net-core-2-0-cookie-authentication-local-logins/</p>
<p>Como Extender Asp.net Identity y customizarlo</p>
<hr />
<h3 id="cookie-authentication-in-aspnet-core-2-without-aspnet-identity"><a class="header" href="#cookie-authentication-in-aspnet-core-2-without-aspnet-identity">Cookie authentication in ASP.NET Core 2 without ASP.NET Identity</a></h3>
<p>https://www.meziantou.net/cookie-authentication-in-asp-net-core-2-without-asp-net-identity.htm</p>
<hr />
<h3 id="getting-started-with-entity-framework-core---aspnet-core"><a class="header" href="#getting-started-with-entity-framework-core---aspnet-core">Getting Started With Entity Framework Core - ASP.NET Core</a></h3>
<p>https://www.learnentityframeworkcore.com/walkthroughs/aspnetcore-application</p>
<h3 id="creacion-de-una-aplicacion-aspnet-core"><a class="header" href="#creacion-de-una-aplicacion-aspnet-core">Creacion de una aplicacion ASP.NET core</a></h3>
<p>para crear una aplicacion ASP.NET core necesitamos desde la linea de comandos los siguiente:</p>
<pre><code>     dotnet new mvc
     
     dotnet add package Microsoft.EntityFrameworkCore.SqlServer
     
     dotnet add package --version 1.1.0-msbuild3-final Microsoft.EntityFrameworkCore.Tools
     
     dotnet restore

     dotnet run
</code></pre>
<p>Si abrimos desde visual studio .csproj incluye la siguiente seccion:</p>
<pre><code>    
   &lt;ItemGroup&gt;
    &lt;DotNetCliToolReference
        Include=&quot;Microsoft.EntityFrameworkCore.Tools.DotNet&quot;
        Version=&quot;1.0.0-msbuild3-final&quot; /&gt;
   &lt;/ItemGroup&gt;
    
</code></pre>
<p>Una vez que tenemos las herramientas de linea de comandos para entityframework podemos consultar lo siguiente:</p>
<code>
    dotnet ef -h
</code>
<p>Una vez que en el proyecto lo tenemos añadido, tenemos que crear un folder llamado Model y añadir lo siguiente:</p>
<ul>
<li>Las clases modelo</li>
<li>La clase contexto de EF</li>
</ul>
<p>Creamos el fichero EFCoreWebDemoContext.cs y tambien las clases modelos:</p>
<pre><code>using Microsoft.EntityFrameworkCore;
namespace EFCoreWebDemo
{
    public class EFCoreWebDemoContext : DbContext
    {
        public DbSet&lt;Book&gt; Books { get; set; }
        public DbSet&lt;Author&gt; Authors { get; set; }
        protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
        {
            optionsBuilder.UseSqlServer(@&quot;Server=.\;Database=EFCoreWebDemo;Trusted_Connection=True;MultipleActiveResultSets=true&quot;);
        }
    }
}
</code></pre>
<p>Añadiendo una migracion:</p>
<pre><code>   dotnet ef migrations add CreateDatabase
</code></pre>
<p>Este comando añadira una carpeta migracions con unos archivos para llevar a cabo la migracion a la base de datos.</p>
<p>Despues para que se aplique la migracion a la base de datos, tenemos que lanzar el suguiente comando:</p>
<pre><code>   dotnet ef database update
</code></pre>
<p>Podemos modicar la base de datos y hacer cambiar y aplicarlo a la base de datos con migraciones.</p>
<p>Por ejemplo añadimos lo siguiente a las clases correspondientes Author.cs y Book.cs</p>
<pre><code>    using System.ComponentModel.DataAnnotations;
</code></pre>
<p>Luego tenemos las clases modelo mencionadas:</p>
<pre><code>public class Book
{
    public int BookId { get; set; }
    [StringLength(255)]
    public string Title { get; set; }
    public int AuthorId { get; set; }
    public Author Author { get; set; }
}
</code></pre>
<pre><code>public class Author
{
    public int AuthorId { get; set; }
    [StringLength(50)]
    public string FirstName { get; set; }
    [StringLength(75)]
    public string LastName { get; set; }
    public ICollection&lt;Book&gt; Books { get; set; } = new List&lt;Book&gt;();
}
</code></pre>
<p>Luego volvemos a lanzar los comandos de migraciones:</p>
<pre><code>    dotnet ef migrations add LimitStrings
</code></pre>
<pre><code>    dotnet ef database update
</code></pre>
<p>Luego en los controladores para trabajar con esos datos, podemos hacer lo siguiente:</p>
<pre><code>using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
namespace EFCoreWebDemo.Controllers
{
    public class AuthorController : Controller
    {
        public async Task&lt;IActionResult&gt; Index()
        {
            using (var context = new EFCoreWebDemoContext())
            {
                var model = await context.Authors.AsNoTracking().ToListAsync();
                return View(model);
            }
            
        }  
        [HttpGet]
        public IActionResult Create()
        {
            return View();
        }
        [HttpPost]
        public async Task&lt;IActionResult&gt; Create([Bind(&quot;FirstName, LastName&quot;)] Author author)
        {
            using (var context = new EFCoreWebDemoContext())
            {
                context.Add(author);
                await context.SaveChangesAsync();
                return RedirectToAction(&quot;Index&quot;);
            }
        }
    }
</code></pre>
<p>Luego tenemos el apartado de la vistas:</p>
<pre><code>@model IEnumerable&lt;Author&gt;
@{
    ViewBag.Title = &quot;Authors&quot;;
}
&lt;h1&gt;@ViewBag.Title&lt;/h1&gt;
&lt;ul&gt;
@foreach (var author in Model)
{
    &lt;li&gt;@author.FirstName @author.LastName&lt;/li&gt;
}
&lt;/ul&gt;
&lt;div&gt;@Html.ActionLink(&quot;New&quot;, &quot;create&quot;)

&lt;/pre&gt;

&lt;pre&gt;
@model Author
@{
    ViewBag.Title = &quot;New Author&quot;;
}
&lt;h1&gt;@ViewBag.Title&lt;/h1&gt;
@using(Html.BeginForm()){
  &lt;div class=&quot;form-group&quot;&gt;
    @Html.LabelFor(model =&gt; model.FirstName)
    @Html.TextBoxFor(model =&gt; model.FirstName, new { @class=&quot;form-control&quot;}) 
  &lt;/div&gt;
  &lt;div class=&quot;form-group&quot;&gt;
    @Html.LabelFor(model =&gt; model.LastName)
    @Html.TextBoxFor(model =&gt; model.LastName, new { @class=&quot;form-control&quot;}) 
  &lt;/div&gt;
  &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;Submit&lt;/button&gt;
}
</code></pre>
<p>luego para ver que todo ha ido bien podemos hacer los siguiente:</p>
<pre><code>    dotnet build
</code></pre>
<pre><code>    dotnet run
</code></pre>
<p>Luego podemos añadir los formularios para ir añadiendo datos a la base de datos:</p>
<pre><code>using System.Threading.Tasks;
using System.Linq;
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using Microsoft.AspNetCore.Mvc.Rendering;
namespace EFCoreWebDemo.Controllers
{
    public class BookController : Controller
    {
        public async Task&lt;IActionResult&gt; Index()
        {
            using (var context = new EFCoreWebDemoContext())
            {
                var model = await context.Authors.Include(a =&gt; a.Books).AsNoTracking().ToListAsync();
                return View(model);
            }
            
        }  
        [HttpGet]
        public async Task&lt;IActionResult&gt; Create()
        {
            using(var context = new EFCoreWebDemoContext())
            {
                var authors = await context.Authors.Select(a =&gt; new SelectListItem {
                    Value = a.AuthorId.ToString(), 
                    Text = $&quot;{a.FirstName} {a.LastName}&quot;
                }).ToListAsync();
                ViewBag.Authors = authors;
            }
            return View();
        }
        [HttpPost]
        public async Task&lt;IActionResult&gt; Create([Bind(&quot;Title, AuthorId&quot;)] Book book)
        {
            using (var context = new EFCoreWebDemoContext())
            {
                context.Books.Add(book);
                await context.SaveChangesAsync();
                return RedirectToAction(&quot;Index&quot;);
            }
        }
    }
}

</code></pre>
<p>Y luego tenemos las vistas asociadas:</p>
<pre><code>@model IEnumerable&lt;Author&gt;
@{
    ViewBag.Title = &quot;Authors and their books&quot;;
}
&lt;h1&gt;@ViewBag.Title&lt;/h1&gt;
@if(Model.Any()){
    &lt;ul&gt;
    @foreach(var author in Model){
        &lt;li&gt;@author.FirstName @author.LastName
            &lt;ul&gt;
            @foreach(var book in author.Books){
                &lt;li&gt;@book.Title&lt;/li&gt;
            }
            &lt;/ul&gt;
        &lt;/li&gt;
    }
    &lt;/ul&gt;
}
&lt;div&gt;@Html.ActionLink(&quot;New&quot;, &quot;create&quot;)
</code></pre>
<pre><code>@model Book
@{
    ViewBag.Title = &quot;New Book&quot;;
}
&lt;h1&gt;@ViewBag.Title&lt;/h1&gt;
@using(Html.BeginForm()){
  &lt;div class=&quot;form-group&quot;&gt;
    @Html.LabelFor(model =&gt; model.AuthorId)
    @Html.DropDownListFor(model =&gt; model.AuthorId, (IEnumerable&lt;SelectListItem&gt;)ViewBag.Authors, string.Empty, new { @class=&quot;form-control&quot;}) 
  &lt;/div&gt;
  &lt;div class=&quot;form-group&quot;&gt;
    @Html.LabelFor(model =&gt; model.Title)
    @Html.TextBoxFor(model =&gt; model.Title, new { @class=&quot;form-control&quot;}) 
  &lt;/div&gt;
  &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;Submit&lt;/button&gt;
}
</code></pre>
<hr />
<h3 id="tutorial-introducción-a-ef-core-en-una-aplicación-web-de-aspnet-core-mvc"><a class="header" href="#tutorial-introducción-a-ef-core-en-una-aplicación-web-de-aspnet-core-mvc">Tutorial: Introducción a EF Core en una aplicación web de ASP.NET Core MVC</a></h3>
<p>https://docs.microsoft.com/es-es/aspnet/core/data/ef-mvc/intro?view=aspnetcore-5.0</p>
<p>Esta para la version ASP.NET core 5.0, tal vez sera valido para ASP.NET 3.1</p>
<p>Tenemos la configuracion de la pagina maesta layout.cshtml en:</p>
<pre><code>    Views/Shared/_Layout.cshtml
</code></pre>
<p>Paquetes Nuget de EF Core:</p>
<p><em>Microsoft.EntityFrameworkCore.SqlServer</em></p>
<p>Con Powershell podemos añadirlo de la siguiente manera:</p>
<pre><code>Install-Package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
Install-Package Microsoft.EntityFrameworkCore.SqlServer

</code></pre>
<p>Aparte de crear los modelos y la base de datos tenemos que crear el contexto de EF:</p>
<pre><code>using ContosoUniversity.Models;
using Microsoft.EntityFrameworkCore;

namespace ContosoUniversity.Data
{
    public class SchoolContext : DbContext
    {
        public SchoolContext(DbContextOptions&lt;SchoolContext&gt; options) : base(options)
        {
        }

        public DbSet&lt;Course&gt; Courses { get; set; }
        public DbSet&lt;Enrollment&gt; Enrollments { get; set; }
        public DbSet&lt;Student&gt; Students { get; set; }

         protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            modelBuilder.Entity&lt;Course&gt;().ToTable(&quot;Course&quot;);
            modelBuilder.Entity&lt;Enrollment&gt;().ToTable(&quot;Enrollment&quot;);
            modelBuilder.Entity&lt;Student&gt;().ToTable(&quot;Student&quot;);
        }


    }
}

</code></pre>
<p>Luego tenemos que registrar el Contexto de EF en el pipeline de ASP.NET core mediante inyeccion de dependencias:</p>
<pre><code>using ContosoUniversity.Data;
using Microsoft.EntityFrameworkCore;
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;

namespace ContosoUniversity
{
    public class Startup
    {
        public Startup(IConfiguration configuration)
        {
            Configuration = configuration;
        }

        public IConfiguration Configuration { get; }

        public void ConfigureServices(IServiceCollection services)
        {
            services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
                options.UseSqlServer(Configuration.GetConnectionString(&quot;DefaultConnection&quot;)));

            services.AddControllersWithViews();
        }
</code></pre>
<p>y en el archivo appsettings.json añadimos lo siguiente:</p>
<pre><code>{
  &quot;ConnectionStrings&quot;: {
    &quot;DefaultConnection&quot;: &quot;Server=(localdb)\\mssqllocaldb;Database=ContosoUniversity1;Trusted_Connection=True;MultipleActiveResultSets=true&quot;
  },
  &quot;Logging&quot;: {
    &quot;LogLevel&quot;: {
      &quot;Default&quot;: &quot;Information&quot;,
      &quot;Microsoft&quot;: &quot;Warning&quot;,
      &quot;Microsoft.Hosting.Lifetime&quot;: &quot;Information&quot;
    }
  },
  &quot;AllowedHosts&quot;: &quot;*&quot;
}
</code></pre>
<p>Añadimos unos filtros de excepcion de la base de datos llamado AddDatabaseDeveloperPageExceptionFilter proporciona informacion util en el entorno de desarrollo.</p>
<pre><code>public void ConfigureServices(IServiceCollection services)
{
    services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
        options.UseSqlServer(Configuration.GetConnectionString(&quot;DefaultConnection&quot;)));

    services.AddDatabaseDeveloperPageExceptionFilter();

    services.AddControllersWithViews();
}
</code></pre>
<p>Aparte de con migraciones podemos crear la base de datos imperativamente con EnsureCreated de la siguiente manera (context.Database.EnsureCreated())</p>
<p>Vamos a crear una carpeta Data y ahi vamos a crear archivo y clase llamada DbInitializer.cs con el codigo siguiente:</p>
<pre><code>using ContosoUniversity.Models;
using System;
using System.Linq;

namespace ContosoUniversity.Data
{
    public static class DbInitializer
    {
        public static void Initialize(SchoolContext context)
        {
            context.Database.EnsureCreated();

            // Look for any students.
            if (context.Students.Any())
            {
                return;   // DB has been seeded
            }

            var students = new Student[]
            {
            new Student{FirstMidName=&quot;Carson&quot;,LastName=&quot;Alexander&quot;,EnrollmentDate=DateTime.Parse(&quot;2005-09-01&quot;)},
            new Student{FirstMidName=&quot;Meredith&quot;,LastName=&quot;Alonso&quot;,EnrollmentDate=DateTime.Parse(&quot;2002-09-01&quot;)},
            new Student{FirstMidName=&quot;Arturo&quot;,LastName=&quot;Anand&quot;,EnrollmentDate=DateTime.Parse(&quot;2003-09-01&quot;)},
            new Student{FirstMidName=&quot;Gytis&quot;,LastName=&quot;Barzdukas&quot;,EnrollmentDate=DateTime.Parse(&quot;2002-09-01&quot;)},
            new Student{FirstMidName=&quot;Yan&quot;,LastName=&quot;Li&quot;,EnrollmentDate=DateTime.Parse(&quot;2002-09-01&quot;)},
            new Student{FirstMidName=&quot;Peggy&quot;,LastName=&quot;Justice&quot;,EnrollmentDate=DateTime.Parse(&quot;2001-09-01&quot;)},
            new Student{FirstMidName=&quot;Laura&quot;,LastName=&quot;Norman&quot;,EnrollmentDate=DateTime.Parse(&quot;2003-09-01&quot;)},
            new Student{FirstMidName=&quot;Nino&quot;,LastName=&quot;Olivetto&quot;,EnrollmentDate=DateTime.Parse(&quot;2005-09-01&quot;)}
            };
            foreach (Student s in students)
            {
                context.Students.Add(s);
            }
            context.SaveChanges();

            var courses = new Course[]
            {
            new Course{CourseID=1050,Title=&quot;Chemistry&quot;,Credits=3},
            new Course{CourseID=4022,Title=&quot;Microeconomics&quot;,Credits=3},
            new Course{CourseID=4041,Title=&quot;Macroeconomics&quot;,Credits=3},
            new Course{CourseID=1045,Title=&quot;Calculus&quot;,Credits=4},
            new Course{CourseID=3141,Title=&quot;Trigonometry&quot;,Credits=4},
            new Course{CourseID=2021,Title=&quot;Composition&quot;,Credits=3},
            new Course{CourseID=2042,Title=&quot;Literature&quot;,Credits=4}
            };
            foreach (Course c in courses)
            {
                context.Courses.Add(c);
            }
            context.SaveChanges();

            var enrollments = new Enrollment[]
            {
            new Enrollment{StudentID=1,CourseID=1050,Grade=Grade.A},
            new Enrollment{StudentID=1,CourseID=4022,Grade=Grade.C},
            new Enrollment{StudentID=1,CourseID=4041,Grade=Grade.B},
            new Enrollment{StudentID=2,CourseID=1045,Grade=Grade.B},
            new Enrollment{StudentID=2,CourseID=3141,Grade=Grade.F},
            new Enrollment{StudentID=2,CourseID=2021,Grade=Grade.F},
            new Enrollment{StudentID=3,CourseID=1050},
            new Enrollment{StudentID=4,CourseID=1050},
            new Enrollment{StudentID=4,CourseID=4022,Grade=Grade.F},
            new Enrollment{StudentID=5,CourseID=4041,Grade=Grade.C},
            new Enrollment{StudentID=6,CourseID=1045},
            new Enrollment{StudentID=7,CourseID=3141,Grade=Grade.A},
            };
            foreach (Enrollment e in enrollments)
            {
                context.Enrollments.Add(e);
            }
            context.SaveChanges();
        }
    }
}
</code></pre>
<p>Y en el program.cs tenemos lo siguiente:</p>
<pre><code>using ContosoUniversity.Data;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Hosting;
using Microsoft.Extensions.Logging;
using System;

namespace ContosoUniversity
{
    public class Program
    {
        public static void Main(string[] args)
        {
            var host = CreateHostBuilder(args).Build();

            CreateDbIfNotExists(host);

            host.Run();
        }

        private static void CreateDbIfNotExists(IHost host)
        {
            using (var scope = host.Services.CreateScope())
            {
                var services = scope.ServiceProvider;
                try
                {
                    var context = services.GetRequiredService&lt;SchoolContext&gt;();
                    DbInitializer.Initialize(context);
                }
                catch (Exception ex)
                {
                    var logger = services.GetRequiredService&lt;ILogger&lt;Program&gt;&gt;();
                    logger.LogError(ex, &quot;An error occurred creating the DB.&quot;);
                }
            }
        }

        public static IHostBuilder CreateHostBuilder(string[] args) =&gt;
            Host.CreateDefaultBuilder(args)
                .ConfigureWebHostDefaults(webBuilder =&gt;
                {
                    webBuilder.UseStartup&lt;Startup&gt;();
                });
    }
}
</code></pre>
<p>Tenemos disponible desde program con el </p>
<ul>
<li>using ContosoUniversity.Data;</li>
<li>using Microsoft.Extensions.DependencyInjection;</li>
</ul>
<p>acceso al servicio de injeccion de dependencias y solicitar una instancia del contexto</p>
<p>Luego en los controladores podemos hacer lo siguiente:</p>
<pre><code>   namespace ContosoUniversity.Controllers
{
    public class StudentsController : Controller
    {
        private readonly SchoolContext _context;

        public StudentsController(SchoolContext context)
        {
            _context = context;
        }


public async Task&lt;IActionResult&gt; Index()
{
    return View(await _context.Students.ToListAsync());
}
</code></pre>
<p>Luego creamos las vistas:</p>
<hr />
<h3 id="haciendo-fácil-el-acceso-a-datos-con-entity-framework-core-parte-2"><a class="header" href="#haciendo-fácil-el-acceso-a-datos-con-entity-framework-core-parte-2">Haciendo fácil el acceso a datos con Entity Framework Core (Parte 2)</a></h3>
<p>https://www.fixedbuffer.com/entity-framework-core-2/</p>
<p>Aqui en este ejemplo utiliza mysql como servidor de base de datos.</p>
<p>Podemos verlo como creando la solucion desde Visual Studio con powershell, o creando la solucion desde Visual studio code y con DotNet Cli.</p>
<p>Instala dos paquetes:</p>
<p>Con powershell desde visual studio</p>
<pre><code>Install-Package Microsoft.EntityFrameworkCore -Version 2.1.3

Install-Package Microsoft.EntityFrameworkCore.Tools -Version 2.1.3

Install-Package Pomelo.EntityFrameworkCore.MySql -Version 2.1.2

</code></pre>
<p>y con DotNet cli </p>
<pre><code>- dotnet new console
– dotnet add package Microsoft.EntityFrameworkCore -v 2.1.3
– dotnet add package Microsoft.EntityFrameworkCore.Tools -v 2.1.3
– dotnet add package Pomelo.EntityFrameworkCore.MySql -v 2.1.2
</code></pre>
<p>Luego tenemos que generar el contexto y los modelos y podemos verlo con las siguientes clases:</p>
<pre><code>//Alumnos.cs
using System;
using System.ComponentModel.DataAnnotations;

namespace PostCore.Data
{
    public class Alumnos
    {
        [Key]
        public int IdAlumno { get; set; } //Clave primaria
        public string Nombre { get; set; } 
        public DateTime Nacimiento { get; set; }
        public int IdCurso { get; set; } //Campo clave foranea

        //Entity Framewrok Core
        public Cursos Curso { get; set; } //Objeto de navegación virtual EFC
    }
}

//Cursos.cs
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;

namespace PostCore.Data
{
    public class Cursos
    {
        //Inicializamos el objeto de navegacion virtual de Entity Framework Core
        public Cursos()
        {
            Alumnos = new HashSet&lt;Alumnos&gt;();
        }

        [Key]
        public int IdCurso { get; set; } //Clave primaria
        public string Nombre { get; set; }
        public string Ciudad { get; set; }
        public int IdProfesor { get; set; } //Campo clave foranea

        //Entity Framewrok Core
        public Profesores Profesor { get; set; } //Objeto de navegación virtual EFC
        public ICollection&lt;Alumnos&gt; Alumnos { get; set; } //Objeto de navegación virtual EFC
    }
}

//Profesores.cs
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;

namespace PostCore.Data
{
    public class Profesores
    {
        //Inicializamos el objeto de navegacion virtual de Entity Framework Core
        public Profesores()
        {
            Cursos = new HashSet&lt;Cursos&gt;();
        }
        [Key]
        public int IdProfesor { get; set; } //Clave primaria
        public string Nombre { get; set; }

        //Entity Framewrok Core
        public ICollection&lt;Cursos&gt; Cursos { get; set; } //Objeto de navegación virtual EFC
    }
}

//PostDbContext.cs
using Microsoft.EntityFrameworkCore;

namespace PostCore.Data
{
    //Heredamos de DbContext nuestro contexto
    class PostDbContext : DbContext
    {
        //Constructor sin parametros
        public PostDbContext()       
        {
        }

        //Constructor con parametros para la configuracion
        public PostDbContext(DbContextOptions options)
        : base(options)
        {
        }

        //Sobreescribimos el metodo OnConfiguring para hacer los ajustes que queramos en caso de
        //llamar al constructor sin parametros
        protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
        {
            //En caso de que el contexto no este configurado, lo configuramos mediante la cadena de conexion
            if (!optionsBuilder.IsConfigured) 
            {
                optionsBuilder.UseMySql(&quot;Server=localhost;Database=postefcore;Uid=root;Pwd=root;&quot;);
            }
        }

        //Tablas de datos
        public virtual DbSet&lt;Alumnos&gt; Alumnos { get; set; }
        public virtual DbSet&lt;Cursos&gt; Cursos { get; set; }
        public virtual DbSet&lt;Profesores&gt; Profesores { get; set; }
    }
}

</code></pre>
<h2 id="entity-framework-core-code-first-en-visual-studio"><a class="header" href="#entity-framework-core-code-first-en-visual-studio">Entity Framework Core «Code First» en Visual Studio</a></h2>
<p>Ahora vamos a ver Entity framework core Code First en visual studio con powershell, los comandos relacionados para hacer migraciones:</p>
<p><strong>add-migration</strong>: Con este comando, generaremos la migración que lanzaremos a la base de datos. Este comando tiene 2 parámetros:</p>
<p>{nombre}: Con este parámetro indicaremos el nombre que queremos indicarle a la migración, ademas, es obligatorio.
-Context {contexto}: En caso de tener más de un contexto de datos en nuestro programa, indicaremos cual de los contextos es mediante este parámetro. Si solo tenemos un contexto de datos, no es obligatorio usarlo.
<strong>remove-migration</strong>: Con este comando, eliminaremos la ultima migración que hemos generado. Se puede utilizar varias veces consecutivamente para ir eliminando migraciones desde la última a la primera.</p>
<p><strong>update-database</strong>: Con este comando, enviaremos a la base de datos los cambios de la migración, haciéndola efectiva:</p>
<p>{nombre}: Con este parámetro indicaremos el nombre de la migración que queremos aplicar.
-Context {contexto}: En caso de tener más de un contexto de datos en nuestro programa, indicaremos cual de los contextos es mediante este parámetro. Si solo tenemos un contexto de datos, no es obligatorio usarlo.
<strong>drop-database</strong>: Con este comando, eliminaremos la base de datos. Este comando tiene 1 parámetro:</p>
<p>-Context {contexto}: En caso de tener más de un contexto de datos en nuestro programa, indicaremos cual de los contextos es mediante este parámetro. Si solo tenemos un contexto de datos, no es obligatorio usarlo.</p>
<p>Y para empezar a utilizar las migraciones, lanzamos el siguiente comando:</p>
<pre><code>add-migration init -Context PostDbContext
</code></pre>
<p>Esto genera una carpeta «Migrations» donde va a ir guardando cada una de las migraciones. Conviene no borrar el contenido, ya que almacena las «versiones» del contexto de datos, de modo que podemos revertir los cambios en la base de datos. Ademas, el hecho de almacenar estas migraciones, permite al sistema aplicar cambios de manera incremental en las próximas migraciones, y es requisito para poder aplicar cambios a la base de datos sin que se produzcan errores por tablas ya existentes.</p>
<p>Con eso, ejecutamos:</p>
<pre><code>  update-database -Context PostDbContext
</code></pre>
<h2 id="entity-framework-core-code-first-en-dotnet-cli"><a class="header" href="#entity-framework-core-code-first-en-dotnet-cli">Entity Framework Core «Code First» en DotNet CLI</a></h2>
<hr />
<h2 id="logging-in-aspnet-core"><a class="header" href="#logging-in-aspnet-core">Logging in ASP.NET Core</a></h2>
<p>https://www.tutorialsteacher.com/core/aspnet-core-logging</p>
<pre><code>Microsoft.Extensions.Logging.Console
Microsoft.Extensions.Logging.Debug
Microsoft.Extensions.Logging.EventSource
Microsoft.Extensions.Logging.TraceSource
</code></pre>
<p>Tenemos en program el siguiente codigo:</p>
<pre><code>public class Program
{
    public static void Main(string[] args)
    {
        CreateWebHostBuilder(args).Build().Run();
    }

    public static IWebHostBuilder CreateWebHostBuilder(string[] args) =&gt;
        WebHost.CreateDefaultBuilder(args)
               .UseStartup&lt;Startup&gt;();
}
</code></pre>
<p>Por defecto tenemos el siguiente codigo en el metodo WebHost.CreateDefaultBuilder() relacionado con tracear el codigo de la aplicacion, y esta porcion de codigo por defecto la podemos ver en github</p>
<pre><code>.ConfigureLogging((hostingContext, logging) =&gt;
    {
        logging.AddConfiguration(hostingContext.Configuration.GetSection(&quot;Logging&quot;));
        logging.AddConsole();
        logging.AddDebug();
        logging.AddEventSourceLogger();
    }).
</code></pre>
<pre><code>
</code></pre>
<hr />
<h2 id="crud-fullstack-react-js-aspnet-core-y-sql-server--tutorial-en-español--parte-1"><a class="header" href="#crud-fullstack-react-js-aspnet-core-y-sql-server--tutorial-en-español--parte-1">CRUD FullStack React JS, ASP.NET Core y SQL Server || Tutorial en Español || Parte 1</a></h2>
<p>https://www.youtube.com/watch?v=Usj0J4rUumI&amp;list=PLqC1FgzJhTiw4HaSmkN8_mMgKlZayIQHe</p>
<p>Creamos un proyecto asp.net core Web api en visual studio</p>
<p>Agregamos el siguiente paquete nuget </p>
<pre><code>Install-Package Microsoft.EntityFrameworkCore.SqlServer -Version 3.1.7
</code></pre>
<ul>
<li>Generamos las clases POCO, con ciertos atributos</li>
<li>Generamos el fichero AppDbContext</li>
<li>Agregamos una cadena de conexion al fichero AppSettings.json</li>
</ul>
<p>Cadena de conexion en AppSettings.json</p>
<pre><code>   .
   .
   .
&quot;ConnectionStrings&quot;: {
    &quot;conexion&quot; : &quot;data source=(LocalDb)\\MSSQLLocalDB; initial catalog=prueba; user id=sa; password=Admin;MultipleActiveResulsets=true&quot;
} 
   .
   .
   .
</code></pre>
<p>Archivo AppDbContext.cs</p>
<pre><code>public class AppDbContext : DbContext
{
     public AppDbContext(DbContextOptions&lt;AppContext&gt; options)
     {

     }
     public DbSet&lt;Gestores_Bd&gt; gestores_bd {get;set;}
     
}


</code></pre>
<p>Luego en el fichero StartUp.cs tenemos que añadir en el metodo ConfigureServices lo siguiente:</p>
<p>Tenemos que habilitar CORS para que puedan hacer llamadas desde la parte frontal</p>
<pre><code>public void ConfigureServices(IServiceCollection services)
{
    services.AddCors();
    services.AddControllers();
    
    services.AddBdContext&lt;AppDbContext&gt;(options =&gt; options.UseSqlServer(Configuration.GetConnectionString(&quot;Conexion&quot;)));
}

public void Configure(IApplicationBuilder app,IwebHostEnvironment env)
{
    app.UseCors(options =&gt; 
    {
        options.WithOrigins(&quot;http://localhost:3000&quot;);
        options.AllowAnyMethod();
        options.AllowAnyHeader();
    });
}

</code></pre>
<p>Clase controlador de API</p>
<pre><code>    .
    .
    .
private readonly AppDbContext context;

//Constructor del controller
public GestoresController()
{
   this.context = context;  
}
   .
   .
   .
</code></pre>
<p>En  un action de tipo get escribimos los siguiente:</p>
<pre><code>
[HttpGet]
public ActionResult Get()
{
    try
    {
        return Ok(context.gestores_bd.ToList());
    }catch(Exception ex)
    {
        return BadRequest(ex.Message);
    }
}

[HttpGet(&quot;{id}&quot;,Name=&quot;GetGestor&quot;)]
public ActionResult Get(int id)
{
    try
    {
    var gestor = context.gestores_bd.FirstOrDefault(g =&gt;g.id == id);
    return Ok(gestor);
    }catch(Exception ex)
    {
        return BadRequest(ex.Message);
    }
}

</code></pre>
<p>Creamos otro actions  para peticiones tipo POST hacemos lo siguiente;</p>
<pre><code>[HttpPost]
public ActionResult Post([FromBody]Gestores_Bd gestor)
{
    try
    {
       context.gestores_bd.Add(gestor);
       context.SaveChanges();
       return CreateAtRoute(&quot;GetGestor&quot;, new { id = gestor.id}, gestor); 
    }catch(Exception ex)
    {
        return BadRequest(ex.Message);
    }
}

</code></pre>
<p>Create otro Action para peticiones PUT de actualizacion:</p>
<pre><code>[HttpPut(&quot;{id}&quot;)]
public ActionResult Put(int id, [FromBody]Gestores_Bd gestor)
{
    try
    {
       if (gestor.id == id)
       {
           context.Entry(gestor).State = EntityState.Modified;
           context.SaveChanges();ç
           return CreatedAtRoute(&quot;GetGestor&quot;, new {id = gestor.id}, gestor);
       }
       else
       {
           return BadRequest();
       }
    }catch (Exception ex)
    {
        return BadRequest();
    }
}
</code></pre>
<p>Crear otra action para borrar un registro</p>
<pre><code>[HttpDelete(&quot;{id}&quot;)]
public ActionResult Delete(int id)
{
    try
    {
        var gestor = context.gestores_bd.FirstOrDefault(g =&gt; g.id == id); 
        if (gestor != null)
        {
            context.gestores_bd.Remove(gestor);
            context.SaveChanges();
            return Ok(id);
        }
    }catch(Exception ex)
    {
        return BadRequest(ex.Message);
    }
}

</code></pre>
<p>Luego vamos a utilizar react en la parte frontal con visual studio code.</p>
<p>Instalamos las siguientes librerias</p>
<pre><code>npm i bootstrap reactstrap axios
</code></pre>
<p>Y creamos el App.js</p>
<pre><code>import React,{useState,useEffect} from 'react';
import './App.css'
import 'bootstrap/dist/css/bootstrap.min.css';
import axios from 'axios';
import {Modal,ModalBody,ModalFooter,ModalHeader} from 'reactstrap';

function App() {
    const baseUrl = &quot;https://-....&quot;
    const [data,setData] = useState([]);
    
    const peticionGet = async() =&gt; {
         await axios.get(baseUrl).then(response =&gt; {
             setData(response.data);

         }).catch(error =&gt; {
             console.log(error)
         })
    }
    
    useEffect(()=&gt;{
        peticionGet();
    },[])
    
     
    return (
        &lt;div className=&quot;App&quot; &gt;
           &lt;table className=&quot;table table-bordered&quot; &gt;
               &lt;thead&gt;
                  &lt;tr&gt;
                     &lt;th&gt;ID&lt;/th&gt;
                     &lt;th&gt;Nombre&lt;/th&gt;
                     &lt;th&gt;Lanzamiento&lt;/th&gt;
                     &lt;th&gt;Desarrollador&lt;/th&gt;
                     &lt;th&gt;Acciones&lt;/th&gt;
                  &lt;/tr&gt;
               &lt;thead&gt;
               &lt;tbody&gt;
                {data.map(gestor =&gt;(
                 &lt;tr key={gestor.id} &gt;
                    &lt;td&gt;{gestor.id}&lt;/td&gt;
                    &lt;td&gt;{gestor.nombre}&lt;/td&gt;
                    &lt;td&gt;{gestor.lanzamiento}&lt;/td&gt;
                    &lt;td&gt;{gestor.desarrollador}&lt;/td&gt;
                    &lt;td&gt;
                        &lt;button className=&quot;btn btn-primary&quot;&gt;Editar&lt;/button&gt; {&quot;  &quot;}
                        &lt;button className=&quot;btn btn-danger&quot;&gt;Eliminar&lt;/button&gt;
                    &lt;/td&gt;
                 &lt;/tr&gt;
                ))}    
               &lt;/tbody&gt;     
           &lt;/table&gt;  
        &lt;/div&gt;
    )
}

export default App;
</code></pre>
<pre><code>
</code></pre>
<hr />
<p>Mini Profiler for ASP.ET Core Projects</p>
<p>https://www.youtube.com/watch?v=7ThPz-9XM54</p>
<hr />
<p>Using .NET Memory Profiler to investigate memory issues</p>
<p>https://www.youtube.com/watch?v=b0tiHyeotRU</p>
<hr />
<p>Using Visual Studio Diagnostic tools to investigate memory issues</p>
<p>https://www.youtube.com/watch?v=TK1HfJ9pn7g</p>
<hr />
<p>Performance Profiling | .NET Object Allocation Tracking Tool</p>
<p>https://www.youtube.com/watch?v=60euKwSqT-U</p>
<hr />
<p>Performance Profiling | CPU Usage Tool</p>
<p>https://www.youtube.com/watch?v=X1-uHpEqNGM</p>
<hr />

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="Apuntes_AspNet_Core_Serilog_SqlServer.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="Apuntes_AspNet_Identidy.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="Apuntes_AspNet_Core_Serilog_SqlServer.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="Apuntes_AspNet_Identidy.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="custom.js"></script>


    </body>
</html>
